library(ggplot2)
library(dplyr)
library(scales)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
params <- 11
dirName <- "16_02_2021/"
fileNames <- list.files(dirName)
rawData <- lapply(fileNames, function(x) {read.table(paste(dirName, x, sep=""), skip = params, sep = "\t", header = TRUE)})
parameters <- lapply(fileNames, function(x) {read.table(paste(dirName, x, sep=""), nrows = params, sep = "\t")})
fileNames
parameters
parameters <- lapply(fileNames, function(x) {data.frame(read.table(paste(dirName, x, sep=""), nrows = params, sep = "\t"))})
parametres
parameters
rawData
rawData <- lapply(fileNames, function(x) {data.frame(read.table(paste(dirName, x, sep=""), skip = params, sep = "\t", header = TRUE))})
seq_along(rawData)
parametres[[1]]
parameters[[1]]
parameters[[1]][1,2]
parameters[[1]][3, 2]
nrow(rawData[[1]])
test <- lapply(seq_along(rawData), function(x) {rawData[[x]]$network_type = rep(parameters[[x]][3,2], nrow(rawData[[x]]))})
test
rawData
test <- lapply(seq_along(rawData), function(x) {rawData[[x]]$network_type <- rep(parameters[[x]][3,2], nrow(rawData[[x]]))})
rawData[[1]]
rawData <- lapply(fileNames, function(x) {data.frame(read.table(paste(dirName, x, sep=""), skip = params, sep = "\t", header = TRUE))})
lapply(seq_along(rawData), function(x) {rawData[[x]]$network_type <- rep(parameters[[x]][3,2], nrow(rawData[[x]]))})
lapply(seq_along(rawData), function(i) {rawData[[i]]$network_type <- rep(parameters[[i]][3,2], nrow(rawData[[i]]))})
head(test[[1]])
rawData[[1]]$message_id
rawData[[1]]$network_Type
rawData[[i]]$network_type <- lapply(seq_along(rawData), function(i) {rep(parameters[[i]][3,2], nrow(rawData[[i]]))})
lapply(seq_along(rawData), function(i) {rep(parameters[[i]][3,2], nrow(rawData[[i]]))})
lapply(seq_along(rawData), function(i) {rawData[[i]]$network_type <- rep(parameters[[i]][3,2], nrow(rawData[[i]]))})
lapply(seq_along(rawData), function(i) {cbind(rawData[i], rawData[[i]]$network_type <- rep(parameters[[i]][3,2], nrow(rawData[[i]])))})
lapply(seq_along(rawData), function(i) {cbind(rawData[[i]], rawData[[i]]$network_type <- rep(parameters[[i]][3,2], nrow(rawData[[i]])))})
test <- lapply(seq_along(rawData), function(i) {cbind(rawData[[i]], rawData[[i]]$network_type <- rep(parameters[[i]][3,2], nrow(rawData[[i]])))})
test[[1]]
test <- lapply(seq_along(rawData), function(i) {cbind(rawData[[i]], network_type = rep(parameters[[i]][3,2], nrow(rawData[[i]])))})
test[[1]]
parameters[[1]]
params <- 11
dirName <- "16_02_2021/"
fileNames <- list.files(dirName)
rawData <- lapply(fileNames, function(x) {data.frame(read.table(paste(dirName, x, sep=""), skip = params, sep = "\t", header = TRUE))})
parameters <- lapply(fileNames, function(x) {data.frame(read.table(paste(dirName, x, sep=""), nrows = params, sep = "\t"))})
rawData <- lapply(seq_along(rawData), function(i) {cbind(rawData[[i]], network_type = rep(parameters[[i]][3,2], nrow(rawData[[i]])))})
rawData <- lapply(seq_along(rawData), function(i) {cbind(rawData[[i]], tau = rep(parameters[[i]][6,2], nrow(rawData[[i]])))})
rawData <- lapply(seq_along(rawData), function(i) {cbind(rawData[[i]], alpha = rep(parameters[[i]][7,2], nrow(rawData[[i]])))})
rawData[[1]] %>% head
data <- lapply(rawData, function(x) {
data.frame(
x %>%
group_by(message_id, network_type, tau, alpha) %>%
summarise(counts = n())
)
})
data
data %>% tail
#data <- bind_rows(data, .id = "realisation")
data <- bind_rows(data)
popularityHistogram <- function() {
breaks <- 220
histogram <- hist(log10(data$counts), breaks = breaks)
factor <- 10^histogram$breaks[-1] - 10^histogram$breaks[-length(histogram$breaks)]
sum <- sum(histogram$counts/factor)
histogram <- data.frame(x = histogram$mids, y = histogram$counts/factor/sum)
histogram <- histogram[histogram$y != 0,]
plot <- ggplot(data = histogram, aes(x = x, y = y)) +
geom_point(size = 3) +
theme(
text=element_text(size=28),
axis.text=element_text(color="black"),
axis.ticks.length = unit(0, "cm"),
plot.title=element_text(hjust=0.5),
panel.border=element_rect(fill=NA),
panel.background=element_blank(),
legend.key=element_rect(fill=NA, color=NA),
legend.background=element_rect(fill=(alpha("white", 0))),
legend.title=element_blank(),
legend.position=c(0.6, 0.8),
legend.box.background=element_rect(colour = "black"),
legend.spacing.y = unit(0, "mm")
) +
xlab("liczba udostepnien jednej informacji") +
ylab("gęstość prawdopodobieństwa") +
scale_x_continuous(labels = math_format(10^.x),
limits = c(0, 3),
breaks = seq(0,5)) +
scale_y_continuous(trans = 'log10',
labels = trans_format("log10", math_format(10^.x)),
limits = c(.3*10^-8, 10^0),
breaks = 10^(-9:0)) +
annotation_logticks(sides="lb")
print(plot)
}
popularityHistogram()
breaks <- 220
histograms <- data.frame(
data %>%
group_by(network_type, tau, alpha) %>%
hist(log10(data$counts), breaks = breaks)
)
histograms <- data.frame(
data %>%
group_by(network_type, tau, alpha) %>%
hist(log10(data$counts), breaks = breaks)
)
rawData
data
data$counts
histograms <- data.frame(
data %>%
group_by(network_type, tau, alpha) %>%
hist(log10(counts), breaks = breaks)
)
histograms <- data.frame(
data %>%
group_by(network_type, tau, alpha) %>%
hist(log10(data$counts), breaks = breaks)
)
data$counts
typeof(data$counts)
histograms <- data.frame(
data %>%
group_by(network_type, tau, alpha) %>%
hist(log10(data$counts), breaks = breaks)
)
histograms
histograms
histograms <- data.frame(
data %>%
group_by(network_type, tau, alpha) %>%
hist(log10(data$counts), breaks = breaks)
)
histograms <- data.frame(
data %>%
group_by(network_type, tau, alpha) %>%
hist(x = log10(data$counts), breaks = breaks)
)
data %>%
group_by(network_type, tau, alpha)
data %>%
group_by(network_type, tau, alpha) %>% hist()
data %>%
group_by(network_type, tau, alpha) %>% hist(counts)
data %>%
group_by(network_type, tau, alpha) %>% hist(data$counts)
data %>%
group_by(network_type, tau, alpha) %>% hist(data$counts)
data %>%
group_by(network_type, tau, alpha) %>% hist(to.numeric(data$counts))
histograms <- data.frame(
data %>%
group_by(network_type, tau, alpha) %>%
hist(data$counts)
)
